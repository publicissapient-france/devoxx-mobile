define(["log","ui"],function(e,t){var n=e.getLogger("db");n.info("Loading db.js");var r={cache:{}},i="xebia";n.info("Creating Lawnchair object");var s=new Lawnchair({name:i},function(e){n.info("Storage open for db: '"+e.name+"' with '"+e.adapter+"' adapter.");var t=this;t.keys({},function(e){_(e).each(function(e){(e.indexOf("/xebian/")>=0||e.indexOf("/xebia/")>=0)&&t.remove(e,function(){n.info("Destroyed following key in db: '"+e+"'")})})})});return n.info("Created Lawnchair object"),r.exists=function(e,t){r.cache[e]&&setTimeout(function(){t(!0)},0),s.get(e,function(e){t(e)})},r.getName=function(){return i},r.remove=function(e,t){r.cache[e]=undefined,s.remove(e,function(){t()})},r.save=function(e,t){r.cache[e]=t,s.save({key:e,value:t})},r.get=function(e,t){r.cache[e]?setTimeout(function(){t(r.cache[e])},0):s.get(e,function(e){t(e?e.value:undefined)})},r.isEquals=function(e,t,n,i){r.cache[e]?setTimeout(function(){n()},0):s.get(e,function(e){e&&e.value===t?n():i()})},r.getOrFetch=function(e,t,n){r.cache[e]?setTimeout(function(){t(r.cache[e])},0):s.get(e,function(e){e?t(e.value):n()})},n.info("Loaded db"),r});