define(["log","ui"],function(a,b){var c=a.getLogger("db");c.info("Loading db.js");var d={cache:{}},e="xebia";c.info("Creating Lawnchair object");var f=new Lawnchair({name:e},function(a){c.info("Storage open for db: '"+a.name+"' with '"+a.adapter+"' adapter.");var b=this;b.keys({},function(a){_(a).each(function(a){(a.indexOf("/xebian/")>=0||a.indexOf("/xebia/")>=0)&&b.remove(a,function(){c.info("Destroyed following key in db: '"+a+"'")})})})});return c.info("Created Lawnchair object"),d.exists=function(a,b){d.cache[a]&&setTimeout(function(){b(!0)},0),f.get(a,function(a){b(a)})},d.getName=function(){return e},d.remove=function(a,b){d.cache[a]=undefined,f.remove(a,function(){b()})},d.save=function(a,b){d.cache[a]=b,f.save({key:a,value:b})},d.get=function(a,b){d.cache[a]?setTimeout(function(){b(d.cache[a])},0):f.get(a,function(a){b(a?a.value:undefined)})},d.isEquals=function(a,b,c,e){d.cache[a]?setTimeout(function(){c()},0):f.get(a,function(a){a&&a.value===b?c():e()})},d.getOrFetch=function(a,b,c){d.cache[a]?setTimeout(function(){b(d.cache[a])},0):f.get(a,function(a){a?b(a.value):c()})},c.info("Loaded db"),d})